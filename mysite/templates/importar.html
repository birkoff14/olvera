{% extends "base.html" %}

{% block content %}

{% load navigation_filters %}

<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
    <div
        class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">{{ titulo }} </h1>
    </div>
    <div class="bg-light p-5 rounded">
        <form class="form-inline mt-2 mt-md-0 needs-validation" novalidate action="{% url 'invoice' %}" name="form1"
            method="POST">
            {% csrf_token %}
            <div class="form-group">
                <div class="container">
                    <div class="row align-items-start">
                        <div class="col">
                            Nombre: <input type="text" class="form-control" name="Cliente">
                            <input type="hidden" name="frmEnvia" value="1">
                        </div>
                        <div class="col">
                            RFC: <select class="form-select" name="RFC">
                                <option value="">Seleccione el RFC</option>
                                {% for dt in rfc %}
                                <option value="{{ dt.Rfc }}">{{ dt.Rfc }}</option>
                                {% endfor %}
                            </select>
                            <div class="invalid-feedback">
                                El RFC es obligatorio.
                            </div>
                        </div>
                        <div class="col">
                            Año: <select class="form-select" name="Anio">
                                <option value="">Seleccione el año</option>
                                {% for dt in anio %}
                                <option value="{{ dt.Año }}">{{ dt.Año }}</option>
                                {% endfor %}
                            </select>
                            <div class="invalid-feedback">
                                El Año es obligatorio.
                            </div>
                        </div>
                        <div class="col">
                            Mes: <select class="form-select" name="Mes">
                                <option value="">Seleccione el mes</option>
                                {% for dt in mes %}
                                <option value="{{ dt.Mes }}">{{ dt.Mes }}</option>
                                {% endfor %}
                            </select>
                            <div class="invalid-feedback">
                                El Mes es obligatorio.
                            </div>
                        </div>
                        <div class="col">
                        </div>
                        <button type="submit" class="btn btn-secondary">Aplicar filtro</button>
                    </div>
                </div>
        </form>
        <hr />
        {% if frmTrue %}
        <br />
        <h5>Filtros aplicados:</h5> <br />
        {{ NombreFiltro }} | {{ frmRFC }} | {{ AñoFiltro }} | {{ MesFiltro }}
        <br /><br />
        {% endif %}
        <div class="table-responsive">
            <table class="table table-striped table-sm" id="tblInicial">
                <thead>
                    <tr align="center">
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>RFC</th>
                        <th>Mes - Año</th>
                        <th>SubTotal</th>
                        <th>Total</th>
                        <th>Moneda</th>
                        <th>Version</th>
                        <th>Total Fact</th>
                        <th>Detalle</th>
                    </tr>
                </thead>
                <tbody>
                    {% for dt in items %}
                    <tr align="center">
                        <td>{{ forloop.counter }}</td>
                        <td>{{ dt.Nombre }}</td>
                        <td>{{ dt.Rfc }}</td>
                        <td>{{ dt.Mes }} - {{ dt.Periodo }}</td>
                        <td>{{ dt.SubTotal }}</td>
                        <td>{{ dt.Total }}</td>
                        <td>{{ dt.Moneda }}</td>
                        <td>{{ dt.Version }}</td>
                        <td>{{ dt.Facturas }}</td>
                        <td>
                            <a class="btn btn-primary"
                                href="{% url 'invoiceDetail' dt.Rfc dt.Periodo dt.Mes dt.Moneda %}">
                                <span class="fa fa-plus-circle"></span> Ver
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!--
    <ul>
        {% for item in items %}
        <li>{{ item.Nombre }}</li>
        {% endfor %}
    </ul>-->

    {% if items.has_next or items.has_previous %}

    <ul class="pagination">
        {% if items.has_previous %}
        <li class="page-item"><a href="?page={{ items.previous_page_number }}" class="page-link">
                <span aria-hidden="true">&laquo;</span>
            </a></li>
        {% endif %}

        {% for page in items.paginator.page_range|page_filter:items %}
        <li class="{% if items.number == page %}page-item active{% endif %}">
            <a class="page-link" href="?page={{ page }}">{{ page }}</a>
        </li>
        {% endfor %}

        {% if items.has_next %}
        <li class="page-item">
            <a href="?page={{ items.next_page_number }}" class="page-link">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        {% endif %}
    </ul>

    {% endif %}
</main>

{% endblock %}